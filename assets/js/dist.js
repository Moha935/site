function debounce(t,o){var e,o=o||200;return function(){var n=this,i=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(n,Array.prototype.slice.call(i))},o)}}function trianglify(){if(oldWidth!=window.innerWidth){var t=document.querySelector("#canvas");for(points=[],polygons=[],oldWidth=window.innerWidth;t.firstChild;)t.removeChild(t.firstChild);var o=30,e=window.innerWidth-2*o,n=window.innerHeight-2*o,i={width:e,height:n};t.setAttributes(i);for(var s=(e+n)/20,r=Math.ceil(e/s)+1,a=Math.ceil(n/s)+1,d=Math.ceil(e/(r-1)),l=Math.ceil(n/(a-1)),p=0;a>p;p++)for(var c=0;r>c;c++)points.push([d*c+(0==c||c==r-1?0:(Math.random()*d-d/2)/1.4),l*p+(0==p||p==a-1?0:(Math.random()*l-l/2)/1.4)]);for(var u=0;u<points.length;u++)if(u%r!=r-1&&a*r-r-1>=u)for(var h=Math.floor(2*Math.random()),f=0;2>f;f++){var m=document.createElementNS(t.namespaceURI,"polygon"),v="";0==h?0==f?v=points[u].join(",")+" "+points[u+r].join(",")+" "+points[u+r+1].join(","):1==f&&(v=points[u].join(",")+" "+points[u+1].join(",")+" "+points[u+r+1].join(",")):1==h&&(0==f?v=points[u].join(",")+" "+points[u+r].join(",")+" "+points[u+1].join(","):1==f&&(v=points[u+r].join(",")+" "+points[u+1].join(",")+" "+points[u+r+1].join(","))),m.setAttributes({"class":"nofill nostroke",points:v,fill:"rgba(0,0,0,"+Math.random()/4+")"}),polygons.push(m),t.appendChild(m)}}}function fetchPosts(t,o){if(t="undefined"!=typeof t?t:0,o="undefined"!=typeof o?o:!1,loadedPosts)for(var e=Math.min(t+10,loadedPosts.length),n=t;e>n;n++){var i=loadedPosts[n],s=document.createElement("li"),r=document.createElement("a");r.innerHTML=i.title,r.setAttribute("href","http://blog.smarchal.com"+i.url),s.appendChild(r),posts.appendChild(s)}else loadPosts(t,!0)}function loadPosts(t,o){var e=new XMLHttpRequest;e.open("GET","http://blog.smarchal.com/posts.json",!0),e.onload=function(){e.status>=200&&e.status<400&&(loadedPosts=JSON.parse(e.responseText).posts,fetchPosts(t,o))},e.send()}function fetchWorks(t,o){if(t="undefined"!=typeof t?t:0,o="undefined"!=typeof o?o:!1,loadedWorks)for(var e=Math.min(t+10,loadedWorks.length),n=t;e>n;n++){var i=loadedWorks[n],s=document.createElement("li"),r=document.createElement("a");r.innerHTML=i.title,r.setAttribute("href",i.url),s.appendChild(r),works.appendChild(s)}else loadWorks(t,!0)}function loadWorks(t,o){var e=new XMLHttpRequest;e.open("GET","http://blog.smarchal.com/works.json",!0),e.onload=function(){e.status>=200&&e.status<400&&(loadedWorks=JSON.parse(e.responseText).works,fetchWorks(t,o))},e.send()}function init(){trianglify(),fetchPosts(),fetchWorks()}var loadedPosts,loadedWorks,posts=document.querySelector(".posts > ul"),works=document.querySelector(".works > ul");Element.prototype.setAttributes=function(t){for(var o in t)this.setAttribute(o,t[o])};var points=[],polygons=[],oldWidth=0;window.addEventListener("DOMContentLoaded",init,!1),window.addEventListener("resize",debounce(trianglify,50));